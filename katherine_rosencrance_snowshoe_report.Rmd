---
title: "Juvenile Snowshoe Hare Exploratory Report"
author: "Katherine Rosencrance"
date: "11/7/2021"
output: 
  html_document: 
    theme: lumen
---
# Introduction


# Data and Analysis


# Juvenile Hare Initial Investigation



## Annual juvenile hare trap counts

```{r setup, include = FALSE, message = FALSE}

# Install packages

knitr::opts_chunk$set(echo = FALSE,message = FALSE,warning = FALSE)
library(tidyverse)
library(here)
library(lubridate)
library(plotly)
library(ggbeeswarm)
library(kableExtra)
library(effsize)
library(broom)

```

```{r}

# read in the data

bonanza_hares <- read_csv(here("data", "bonanza_hares.csv"))

```

```{r}

# Wrangle to produce graph of total number of juvenile trappings during each year of the study

## filter by age, convert dates into usable format, and add a new column with year
juvenile_hare_traps <- bonanza_hares %>% 
  filter(age == "j") %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = year(date))
  
```

```{r}
## create summary table to include count of traps by year

juvenile_table <- juvenile_hare_traps %>% 
  group_by(year) %>% 
  summarise(count = n())

```


```{r include = FALSE}

## produce graph
annual_juvenile_graph <- ggplot(data = juvenile_table, aes(x = year, y = count)) +
  geom_bar(color = "coral4",
           fill = "coral3",
           stat = "identity",
           alpha = 0.7)+
  scale_x_continuous(breaks = 1999:2012)+
  scale_y_continuous(limits=c(0, 130),
                     breaks = c(0, 25, 50, 75, 100, 125))+
  theme_gray()+
  labs( x = "Year",
        y = "Number of Juvenile Hare Trapped",
        title = "Annual Juvenile Hare Trap Counts",
        subtitle = "1999-2012")+
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.title.x = element_text(vjust = 0.2))

annual_juvenile_graph


```

```{r}
## make it interactive
ggplotly(annual_juvenile_graph)

```


**Figure 1:** Annual juvenile hare trap counts- 



```{r}
## Use table to get summary statistics for yearly traps
juvenile_summary_table <- juvenile_table %>% 
  summarise(mean_traps = mean(count),
            median_traps = median(count),
            max_traps = max(count),
            min_traps = min(count))

```


The data visualization clearly shows that there is a huge variation between years in the number of juvenile hares that were collected. The max was `r juvenile_summary_table$max_traps` and the minimum was `r juvenile_summary_table$min_traps`, excluding the years there were no data. In general, there is a larger number of hares collected in the first few years of the study than in the last part. The mean number of juvenile hares trapped over the 13 year period is `r juvenile_summary_table$mean_traps` while the median is only `r juvenile_summary_table$median_traps`. In moving forward, I would make sure that the people collecting data know that it is crucial to have uniform sampling effort from year to year. This means sampling at similar times each month with the same amount of traps set and the same amount of days. If the effort varies from year to year, the data will no longer reflect actual sample size. 



## Visulize juvenile hare weights

```{r}
# Create new subset with names in observations changed to full names
juvenile_for_beeswarm <- juvenile_hare_traps %>% 
  mutate(grid = case_when(grid == "bonrip" ~ "Riparian",
    grid == "bonmat" ~ "Mature",
    grid == "bonbs" ~ "Black Spruce")) %>% 
    mutate(sex = case_when(
      sex == "f" ~ "female",
      sex == "m" ~ "male",
      is.na(sex) == TRUE ~ "unknown"))

# Visualize data where only juvenile hares are compared by sex and site
ggplot(data = juvenile_for_beeswarm, aes(x = sex, y = weight, color = sex)) +
  geom_beeswarm(cex = 3) +
  scale_color_manual(values = c("coral1","cornflowerblue","azure4")) +
  theme_minimal() +
  stat_summary(fun=mean, 
               geom="point", 
               shape=20, 
               size=4, 
               color="black", 
               fill="black")+
  labs(x = "Sex",
       y = "Weight (g)",
       title = "Juvenile Hare Weight (g) by Sex and Grid") +
 theme(plot.title=element_text(hjust = 0.5),
       panel.border = element_rect(colour = "black",
                                   fill=NA,
                                   size=0.5)) +
  facet_wrap(~grid)

  
  

```

**Figure 2:** Weight observations for juvenile hares taken at 3 different sites. The sites include a mature lowland black spruce stand (Black Spruce), stands of mature white spruce, paper birch, and alder, as well as black spruce (Mature), and flood zone along the Tanana River (Riparian). Females are represented by the coral points and male represented by blue. Hares trapped, but with no sex, are represented as gray points. Weight is measured in grams.

This graph displays the distribution of hare weight according to sex and site. It can be observed that there were a lot more hares trapped in the riparian site than the other two sites. 

## Juvenile Weight Comparison (Male and Female snowshoe hare)

```{r}
# Create table of summary statistics for male and female hare weight

juv_summary_table <- juvenile_for_beeswarm %>%
  filter(sex != "unknown") %>% 
  group_by(sex) %>% 
  summarize(mean_weight = round(mean(weight, na.rm = TRUE),2),
    sd_weight = round(sd(weight, na.rm = TRUE),2),
    n = n()
  )

juv_summary_table %>% 
  kable(col.names = c("Sex", "Mean weight (g)", "Standard deviation (g)", "Sample size"), caption = "Table 1: Summary Statistics for male and female hares captured from 1999-2012") %>% 
  kable_styling(bootstrap_options = "striped", full_width = FALSE)
```

```{r}
# pull vectors of weight for male and female
m_weight <- juvenile_for_beeswarm %>% 
  filter(sex == "male") %>%
  filter(weight != "unknown") %>% 
  pull(weight)

f_weight <- juvenile_for_beeswarm %>% 
  filter(sex == "female") %>% 
  filter(weight != "unknown") %>% 
  pull(weight)

# Plot histograms and qqplots to check assumptions
hist(m_weight) # Looks relatively normal, maybe negatively skewed
qqnorm(m_weight) # Relatively linear
hist(f_weight) # Possibly a bit negatively skewed
qqnorm(f_weight) # Looks very linear

# Assumptions look correct, everything looks relatively normally distributed and linear

# Run the t test
juvenile_ttest <- t.test(f_weight, f_weight)

# Get the tidy model results to call outputs in-line
juvenile_ttest_tidy <- tidy(juvenile_ttest)

# Get the means & SDs for each: 
male_mean <- mean(m_weight)
female_mean <- mean(f_weight)
male_sd <- sd(m_weight)
female_sd <- sd(f_weight)

# Effect size
mf_effsize <- cohen.d(m_weight, f_weight)

mf_effsize
```
My main takeaways from this data is that

## Relationship between juvenile weight and hind foot length

```{r}
# Do linear regression
juvenile_lm <- lm(weight ~ hindft, data = juvenile_for_beeswarm)

# Get tidy versions of the model output to call later on in text
juvenile_lm_tidy_tidy <- tidy(juvenile_lm)
juvenile_lm_glance <- glance(juvenile_lm)

# See model diagnostics:
# plot(juvenile_lm) in console

# Get Pearson's r correlation
juvenile_cor <- cor.test(juvenile_for_beeswarm$weight, juvenile_for_beeswarm$hindft)

# Tidy version of correlation output:
juvenile_cor_tidy <- tidy(juvenile_cor)
```


```{r}
# Create graph exploring correlation between hind foot length and weight in juvenile hares

ggplot(data = juvenile_for_beeswarm, aes(x = hindft, y = weight))+
  geom_point(size = 2, color = "thistle")+
  theme_dark()+
  theme(plot.title=element_text(hjust = 0.5))+
  theme(plot.subtitle=element_text(hjust = 0.5))+
  labs(x = "Hindfoot Length (mm)", y = "Weight (g)", title = "Hindfoot Length (mm) Vs Weight (g) in Juvenile Snowshoe Hares",
       subtitle = "1999-2012")+
   geom_smooth(method = "lm", se = FALSE, color = "cornsilk")
```

**Figure 3:** Hindfoot length (mm) versus weight (g) in juvenile snowshoe hares.  


